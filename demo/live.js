function tabClick(a,b){var c=$(a).find("li"),d=$(document).find(".tab-ops");$(c).click(function(){$("html, body").animate({scrollTop:0},"slow"),$(c).removeClass(b),$(this).addClass(b);var a=$(this).index();$(d).addClass("hide"),$(d).eq(a).removeClass("hide"),configs.tab?configs.tab=!1:configs.tab=!0})}function addDate(a,b){var c=new Date,d=new Date(a);if(b>0&&c.getTime()-d.getTime()<864e5)return!1;d.setDate(d.getDate()+b);var e=d.getMonth()+1,f=d.getDate();10>e&&(e="0"+e),10>f&&(f="0"+f);var g=d.getFullYear()+"-"+e+"-"+f;return g}function livePages(a){if(configs.news.last_id>0){var b=$(".js-live-list");JQAjax.get(this,{url:configs.news.url+"?last_id="+configs.news.last_id,callback:function(c){configs.news.last_id=c.lastId,a?($(b).append(c.html),initPhotoSwipeFromDOM(".my-gallery")):$(b).html(c.html)}})}}function chatPages(){if(configs.chat.last_id>0){var a=$(".js-chat-list");JQAjax.get(this,{url:configs.chat.url+"?last_id="+configs.chat.last_id,wait:!0,callback:function(b){configs.chat.last_id=b.lastId,$(a).append(b.html)}})}}function loadData(a){insertLive(a),delData(a),insertTop(a),insertChat(a)}function playerVideo(){$(document).on("click",".video-player",function(){$(".video-player").show(),$(".px-video-container").remove(),$(".q-player").remove();var a=$(this).data("url"),b="v_"+$(this).data("id"),c=$(this).data("type"),d="";if($(this).hide(),"online"==c)d='<div class="px-video-container text-center" id="'+b+'"><div class="px-video-img-captions-container"><div class="px-video-captions hide"></div><video width="272" height="153" poster="" controls ><source src="'+a+'"/></video></div><div class="px-video-controls"></div></div>',$(this).parents(".js-media").append(d),new InitPxVideo({videoId:b,captionsOnDefault:!0,seekInterval:20,videoTitle:"video",debug:!0}),$("#"+b).find("video")[0].play();else{d='<div class="q-player" id="'+b+'"></div>',$(this).parents(".js-media").append(d);var e={auto_play:"1",file_id:a,app_id:configs.app_id,width:272,height:153};new qcVideo.Player(b,e)}})}function insertLive(a){var b=a.news.newMessage;if(void 0!=b&&""!==b&&null!=b){var c="";$.each(b,function(a,d){c='<li class="live-li clearfix" id="live-'+b[a].id+'"><div class="js-live-time live-time">'+b[a].create_time+'<img src="'+configs.img_url+'"></div><div class="live-content"><div class="js-live-text">'+b[a].content+'</div><div class="my-gallery js-media">',void 0!=b[a].imgs&&0!=b[a].imgs&&"0"!=b[a].imgs&&$.each(b[a].imgs,function(a,b){c+='<figure><a href="'+b+'" data-size="800x800"><img src="'+b+'"/></a></figure>'}),null!==b[a].vod&&void 0!=b[a].vod&&"0"!=b[a].vod&&""!=b[a].vod&&(c+='<a href="javascript:;" class="video-player" data-type="'+b[a].vod.type+'" data-url="'+b[a].vod.url+'" data-id="'+b[a].id+'"><img src="'+b[a].vod.cover+'"/><img class="video-player-btn" src="'+configs.video_player+'"/></a>'),c+="</div></div></li>",$(".js-live-list").prepend(c),initPhotoSwipeFromDOM(".my-gallery")})}}function insertTop(a){var b=a.news.stickMessage;if(void 0!=b&&""!==b&&null!=b&&0!=b){var c='<div class="ptop" id="stick-'+b.id+'"><div class="ptop-content">'+b.content+'</div><div class="my-gallery">';void 0!=b.imgs&&0!=b.imgs&&"0"!=b.imgs&&$.each(b.imgs,function(a,b){c+='<figure><a href="'+b+'" data-size="800x800"><img src="'+b+'"/></a></figure>'}),null!=b.vod&&void 0!=b.vod&&"0"!=b.vod&&""!=b.vod&&(c+='<a href="javascript:;" class="video-player" data-type="'+b.vod.type+'" data-url="'+b.vod.url+'" data-id="'+b.id+'"><img src="'+b.vod.cover+'"/><img class="video-player-btn" src="'+configs.video_player+'"/></a>'),c+="</div></div>",$(".js-stick-msg").html(c),initPhotoSwipeFromDOM(".my-gallery")}}function insertChat(a){var b=a.chats.newMessage,c="";void 0!=b&&""!==b&&null!=b&&0!=b&&($.each(b,function(a,d){c+='<li class="is-reply relative mt10 mr10 ml10 bb" onclick="javascript:;" id="chat-'+b[a].id+"-"+(b[a].reply_id>0?b[a].reply_id:0)+'" data-id="'+b[a].id+'"><div class="clearfix"><div class="chat-img"><a href="javascript:;"><img src="'+b[a].avatar+'"/></a></div><div class="chat-content color-999 clearfix"><span>'+b[a].username+'</span><span class="pull-right">'+b[a].create_time+'</span><p class="mt5 mb10 color-333">'+b[a].content+"</p></div></div>",void 0!=b[a].reply&&(c+='<div class="chat-reply"><div class="chat-img text-center"><i class="color-b08654 icon-mail-reply icon-rotate-180"></i></div><div class="chat-content color-999 clearfix"><div class="chat-img"><a href="javascript:;"><img src="'+b[a].reply.avatar+'"/></a></div><div class="chat-content color-999 clearfix"><span>'+b[a].reply.username+'</span><p class="mt5 mb10 color-333 mr10">'+b[a].reply.content+"</p></div></div></div>"),c+="</li>"}),$(".js-chat-list").prepend(c))}function delData(a){var b=a.news.delMessage;0!=b&&$.each(b,function(c,d){var e=$("#live-"+b[c].id);$("#stick-"+b[c].id).length>0?($("#stick-"+b[c].id).remove(),$(e).show()):a.newsStickId==b[c].id?$(e).hide():$(e).isHidden?$(e).show():$(e).remove()});var c=a.chats.delMessage;if(0!=c){var d=0;$.each(c,function(a,b){d=c[a].reply_id>0?c[a].reply_id:0,$("#chat-"+c[a].id+"-"+d).remove()})}}if(tabClick($(".js-live-tab"),"live-cur"),$(".js-up-date").click(function(){var a=$(".js-live-date").html(),b=addDate(a,1);b?($(".js-live-date").html(b),configs.news.date=b,livePages(!1)):console.log("false")}),$(".js-down-date").click(function(){var a=$(".js-live-date").html(),b=addDate(a,-1);$(".js-live-date").html(b),configs.news.date=b,livePages(!1)}),$("#live-carousel").length>0){$("#live-carousel").carousel({interval:!1});var myElement=document.getElementById("live-carousel"),hammertime=new Hammer(myElement);hammertime.on("panleft",function(a){$(myElement).carousel("next")}),hammertime.on("panright",function(a){$(myElement).carousel("prev")})}var initPhotoSwipeFromDOM=function(a){for(var b=function(a){for(var b,c,d,e,f=a.childNodes,g=f.length,h=[],i=0;g>i;i++)b=f[i],1===b.nodeType&&(c=b.children[0],d=c.getAttribute("data-size").split("x"),console.log(c.getAttribute("data-size")),d[0]=c.childNodes[0].naturalWidth,d[1]=c.childNodes[0].naturalHeight,e={src:c.getAttribute("href"),w:parseInt(d[0],10),h:parseInt(d[1],10)},b.children.length>1&&(e.title=b.children[1].innerHTML),c.children.length>0&&(e.msrc=c.children[0].getAttribute("src")),e.el=b,h.push(e));return h},c=function k(a,b){return a&&(b(a)?a:k(a.parentNode,b))},d=function(a){a=a||window.event,a.preventDefault?a.preventDefault():a.returnValue=!1;var b=a.target||a.srcElement,d=c(b,function(a){return a.tagName&&"FIGURE"===a.tagName.toUpperCase()});if(d){for(var e,g=d.parentNode,h=d.parentNode.childNodes,i=h.length,j=0,k=0;i>k;k++)if(1===h[k].nodeType){if(h[k]===d){e=j;break}j++}return e>=0&&f(e,g),!1}},e=function(){var a=window.location.hash.substring(1),b={};if(a.length<5)return b;for(var c=a.split("&"),d=0;d<c.length;d++)if(c[d]){var e=c[d].split("=");e.length<2||(b[e[0]]=e[1])}return b.gid&&(b.gid=parseInt(b.gid,10)),b},f=function(a,c,d,e){var f,g,h,i=document.querySelectorAll(".pswp")[0];if(h=b(c),g={galleryUID:c.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(a){var b=h[a].el.getElementsByTagName("img")[0],c=window.pageYOffset||document.documentElement.scrollTop,d=b.getBoundingClientRect();return{x:d.left,y:d.top+c,w:d.width}},tapToClose:!0},e)if(g.galleryPIDs){for(var j=0;j<h.length;j++)if(h[j].pid==a){g.index=j;break}}else g.index=parseInt(a,10)-1;else g.index=parseInt(a,10);isNaN(g.index)||(d&&(g.showAnimationDuration=0),f=new PhotoSwipe(i,PhotoSwipeUI_Default,h,g),f.init())},g=document.querySelectorAll(a),h=0,i=g.length;i>h;h++)g[h].setAttribute("data-pswp-uid",h+1),g[h].onclick=d;var j=e();j.pid&&j.gid&&f(j.pid,g[j.gid-1],!0,!0)};